# 权限管理 


##  1.	概览
权限管理，一般指根据系统设置的安全规则或者安全策略，用户可以访问而且只能访问自己被授权的资源。
本平台中权限管理主要关注的任务有：

**（1）功能级权限管理；
（2）数据级权限管理；
（3）用户的管理；
（4）非功能性需求。**

首先要实现的是功能权限管理，对登录的用户进行权限验证来判断其是否有权使用该功能；其次对于数据权限管理，要求可以依据不同用户的角色来划分数据集，做到细粒度及数据级的权限管理；
此外，企业级用户可以进行用户的管理和角色分配，并可以创建普通用户；最后要提高权限管理的健壮性和可靠性。
## 2.	权限管理功能点介绍

### 2.1	用户管理

登入平台时，可实现正确的用户认证过程（由于用户认证过程不属于真正的权限管理范畴，在此不过多描述），点击已登录的用户头像，可以对当前用户的信息进行修改：
>（1）登录密码；  
>（2）绑定手机号，邮箱账号或密保问题等安全性认证问题；  
>（3）企业信息及备注。  
以下内容为特定角色才具有的权限，非特定角色外无法修改  
>（4）项目成员  
>（5）成员用户的权限  
用户管理模块能实现对不同用户的角色划分及信息修改，主要基于以下的概念：
![RBAC权限模型](https://gss3.bdstatic.com/-Po3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike60%2C5%2C5%2C60%2C20/sign=f2517e4c6e061d95694b3f6a1a9d61b4/91ef76c6a7efce1bc646cfbeaf51f3deb48f6550.jpg)
### 2.2	功能权限  

根据不同用户身份来确定不同的可见、可操作的功能范围。  
>   （1）对象级功能模块：在目录、菜单上加权限控制，有权限的可以看到对应菜单名，没有权限无法看到；在业务模块的功能按钮上加权限控制，对无权限的角色隐藏一些按钮。  

>   （2）操作点权限模块：对管理员类角色赋予创建，删除等操作权限，对普通角色只赋予查询权限。  

 >  （3）字段权限模块：展示信息时加以控制，对特定用户进行字段信息隐藏。  

 >  （4）超级管理员模块：对用户的角色进行分配和改动。

### 2.3	数据权限
#### 2.3.1	基础数据权限
>（1）私有：所有数据遵循相关团队成员（包括负责人）及其上级对数据可见，且对这条数据具备同样的权限【只读、可编辑】，上级部门的部门负责人可以看到下级部门的所有数据。

>（2）公开只读：所有数据对团队公开，单条数据的负责人及其上级、以及相关团队具备编辑权限的成员可以编辑该数据。

>（3）公开读写：所有数据对团队公开，全员可编辑。
#### 2.3.2	数据共享
数据共享规则是将数据来源的某个对象全部负责的数据共享给特定的共享范围。配置数据共享规则后，被共享方对共享方所负责的所有数据可见，并具备共享权限对应的操作权限。

### 2.4	角色分类  
初步拟定下列角色及权限：  
>（1）项目经理：具有管理项目的权限，管理团队成员角色的权限，具有具有平台所有功能的使用权限。  

>（2）后台管理员：具有管理团队成员角色的权限，具有平台所有功能的使用权限。  

>（3）员工：具有测试服务，代码管理服务，项目管理服务业务层权限。  

>（4）测试角色：具有单块测试的权限。  

>（5）流水线测试角色：具有流水线服务，容器镜像服务及管理底层服务的权限。

>（6）代码管理角色：具有代码管理服务的权限。

>（7）项目管理角色：具有项目管理服务的权限。

>（8）容器镜像管理角色：具有容器镜像服务及管理底层服务的权限。


### 2.5	数据权限范围说明
规定发布任何代码和项目说明文档时具有是否公开的选项，若选择公开则所有成员可见，若不公开，则只有特定用户可见，只有选择共享后其他用户才能看到。


## 三、功能需求详细叙述
### 3.1 角色需求
| 角色名称 | 功能权限/数据权限 |备注 |
| :------: | :--------------:| :--:|
| 员工角色 | 登录系统 | |
| | 修改密码 | |
| | 绑定手机/邮箱 | |
| | 查看企业信息 | |
| | 查看各模块详情 | |
| | 查看待办 | |
| | 编写代码 | |
| 测试角色 | 可以使用测试模块所有功能/数据 | 详见测试模块需求文档 |
| 代码管理角色 | 可以使用代码管理模块所有功能/数据 | 详见代码管理模块需求文档 | 
| 项目管理角色 | 可以使用项目管理模块所有功能/数据 | 详见项目管理模块需求文档 | 
| 容器镜像管理角色 | 可以使用容器镜像管理模块所有功能/数据 | 详见容器镜像管理模块需求文档 | 
| 流水线测试角色 | 可以使用流水线测试模块所有功能/数据 | 详见流水线测试模块需求文档 | 
| | 可以使用测试模块所有功能| |
| | 可以使用容器镜像管理模块所有功能 | |
| | 可以使用代码管理模块所有功能 | |
| 后台管理角色| 添加角色 | |
| | 编辑角色 | |
| | 删除角色 | |
| | 管理角色分配| |
| 项目经理角色| 新建产品/项目 | |
| | 删除产品/项目| |
| | 管理员工| |
| | 管理后台数据库 | |
### 3.2	 用户需求

| 用户身份 | 包含角色 |备注 |
| :-----: | :-----:| :--:|
| 超级管理员 | 员工角色 | |
| | 测试角色 | |
| | 代码管理角色 | |
| | 项目管理角色 | |
| | 容器镜像管理角色 | |
| | 流水线测试角色 | |
| | 后台管理角色 | |
| | 项目经理角色 | |
| 项目经理 | 员工角色 | |
| | 测试角色 | |
| | 代码管理角色 | |
| | 项目管理角色 | |
| | 容器镜像管理角色 | |
| | 流水线测试角色 | |
| | 项目经理角色 | |
| 代码测试员 | 员工角色| |
| | 测试角色| |
| 代码管理员 | 员工角色|  |
| | 代码管理角色| |
| 项目管理员 | 员工角色|  |
| | 项目管理角色| |
| | 代码管理角色| |
| 容器镜像管理员 | 员工角色|  |
| | 容器镜像管理角色| |
| 流水线测试员 | 员工角色|  |
| | 流水线测试角色 | |
## 四、	功能点分析

| 模块 | 功能点 | M | S | C | W | 约束 | 估时/人日 |
|:---:|:---:|:--: | :--: | :---: | :--: | :---: |:--: |
| 普通角色模块 | 登录功能 |Y| | | | |2|
| | 登出功能 |Y| | | | |1|
| | 修改密码 |Y| | | | |1|
| | 绑定手机/邮箱 | | |Y | | |2|
| | 设计相应UI展示 | | | |Y| |1|
| 管理角色模块 | 添加角色 |Y| | | | |2|
| | 编辑角色 | |Y| | | |3|
| | 删除角色 |Y| | | | |1|
| | 管理角色分配 | |Y| | | |2|
| | 新建项目 |Y| | | | |2| 
| | 删除项目 |Y| | | | |1| 
| | 管理员工 |Y| | | | |2| 
| | 管理后台数据 | |Y| | | |2| 
| 员工角色模块 | 接入模块 |Y|| | | | |4| 
| | 设计相应UI展示 |Y| | | | |3|
| | 显示相关数据 |Y| | | | |3|
| | 隐藏相关数据 |Y| | | | |3|
| 其他 | 权限设计 |Y|| | | | |2| 
| | 各模块依赖 |Y|| | | | |4| 
